webpackJsonp([22],{"8N5Y":function(e,t){},MVcn:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("ZmIX"),n=i("5YLu"),a=i("gjrl"),l={props:{},data:function(){return{navData:[{name:"实验列表",path:"/admin/courseList/experiment/"+this.$route.params.courseId},{name:"实验详情",path:""}],isLock:!1,isOver:!1,detail:{},editMessage:!1,editDetail:!1,editFile:!1,editAnswer:!1,editAnswerFile:!1,editOperate:!1,form:{isAnswerQuezhi:"0"},rules:{experimentName:[{required:!0,message:"不能为空",trigger:"blur"}],valve:[{required:!0,message:"不能为空",trigger:"blur"}]},experimentDetailFile:[],experimentAnswerFile:[]}},computed:{},created:function(){this.init()},mounted:function(){},filters:{recordStatus:function(e){switch(e){case 0:return"正常";case 1:return"锁定";case 2:return"删除";case 3:return"结束";default:return""}}},watch:{},methods:{handleFileSuccess:function(e,t){e.response&&this.detail.experimentDetailFile.push(e.response.data),this.experimentDetailFile=t,console.log("su",this.detail.experimentDetailFile)},handleFileRemove:function(e,t){this.$refs.uploadDetailFile.clearFiles(),this.experimentDetailFile=t,console.log("mv",this.experimentDetailFile)},handleAnswerFileSuccess:function(e,t){e.response&&this.detail.experimentAnswerFile.push(e.response.data),this.experimentAnswerFile=t},handleAnswerFileRemove:function(e,t){this.$refs.uploadAnswerFile.clearFiles(),this.experimentAnswerFile=t},updateInfo:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$http.post("/teaching/teacher/experiment/updateExperimentInfo",{experimentId:t.detail.experimentId,experimentName:t.detail.experimentName,valve:t.detail.valve,experimentIntro:t.detail.experimentIntro}).then(function(e){"0"==e.data.code?(t.editMessage=!1,t.$message({message:"更新成功！",type:"success"})):"1"==e.data.code?t.$router.push("/login"):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){console.log(e)})})},updateDetail:function(){var e=this;this.$http.post("/teaching/teacher/experiment/updateExperimentDetail",{experimentDetailId:this.detail.experimentDetailId,experimentText:this.detail.experimentText}).then(function(t){"0"==t.data.code?(e.editDetail=!1,e.$message({message:"更新成功！",type:"success"})):e.$message({message:t.data.msg,type:"error"}),e.loading=!1}).catch(function(e){console.log(e)})},updateDetailFile:function(e){var t=this;console.log("123"),this.$http.post("/teaching/teacher/experiment/updateExperimentFile",{experimentId:this.detail.experimentId,experimentDetailFile:e}).then(function(e){"0"==e.data.code?(t.editFile=!1,t.init(),t.$message({message:"更新成功！",type:"success"})):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){console.log(e)})},updateAnswer:function(){var e=this;this.$http.post("/teaching/teacher/experiment/updateExperimentAnswer",{experimentAnswerId:this.detail.experimentAnswerId,experimentAnswerContent:this.detail.experimentAnswerContent,experimentId:this.detail.experimentId,punishment:this.detail.punishment}).then(function(t){"0"==t.data.code?(e.editAnswer=!1,e.$message({message:"更新成功！",type:"success"})):e.$message({message:t.data.msg,type:"error"}),e.loading=!1}).catch(function(e){console.log(e)})},updateAnswerFile:function(){var e=this;this.$http.post("/teaching/teacher/experiment/updateExperimentAnswerFile",{experimentAnswerId:this.detail.experimentAnswerId,experimentAnswerFile:this.filterFiles(this.detail.experimentAnswerFile,this.experimentAnswerFile)}).then(function(t){"0"==t.data.code?(e.editAnswerFile=!1,e.init(),e.$message({message:"更新成功！",type:"success"})):e.$message({message:t.data.msg,type:"error"}),e.loading=!1}).catch(function(e){console.log(e)})},lockExperiment:function(){var e=this;this.$http.get("/teaching/teacher/experiment/lock/"+this.$route.params.experimentId).then(function(t){"0"==t.data.code?(e.$message({message:t.data.msg,type:"success"}),e.init(),e.isLock=!0):e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)})},recoverExperiment:function(){var e=this;this.$http.get("/teaching/teacher/experiment/unlock/"+this.$route.params.experimentId).then(function(t){"0"==t.data.code?(e.$message({message:t.data.msg,type:"success"}),e.init(),e.isLock=!1):e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)})},overExperiment:function(){var e=this;this.$http.get("/teaching/teacher/experiment/end/"+this.$route.params.experimentId).then(function(t){"0"==t.data.code?(e.$message({message:t.data.msg,type:"success"}),e.init(),e.isOver=!0):e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)})},delExperiment:function(){var e=this;this.$http.get("/teaching/teacher/experiment/invalid/"+this.$route.params.experimentId).then(function(t){"0"==t.data.code?e.$router.push("/admin/courseList/experiment/"+e.$route.params.courseId):e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)})},closeInfo:function(){this.editMessage=!1,this.init()},closeDetail:function(){this.editDetail=!1,this.init()},closeDetailFile:function(){this.editFile=!1,this.init()},closeAnswer:function(){this.editAnswer=!1,this.init()},closeAnswerFile:function(){this.editAnswerFile=!1,this.init()},transformFile:function(e){var t=[];if(e instanceof Array)for(var i=0;i<e.length;i++)t.push({name:e[i].fileName,url:e[i].filePath});return t},filterFiles:function(e,t){for(var i=[],s=0;s<t.length;s++)for(var n=0;n<e.length;n++)if(t[s].name==e[n].fileName){i.push(e[n]);break}return i},init:function(){var e=this;this.$http.get("/teaching/teacher/experiment/detail/"+this.$route.params.experimentId).then(function(t){"0"==t.data.code?(e.detail=t.data.data,e.experimentDetailFile=e.transformFile(e.detail.experimentDetailFile),e.experimentAnswerFile=e.transformFile(e.detail.experimentAnswerFile),e.detail.experimentDetailFile||(e.detail.experimentDetailFile=[]),e.detail.experimentAnswerFile||(e.detail.experimentAnswerFile=[]),3==e.detail.experimentStatus&&(e.isOver=!0),1==e.detail.experimentStatus&&(e.isLock=!0),0==e.detail.experimentStatus&&(e.isLock=!1)):e.$message({message:t.data.msg,type:"error"}),e.loading=!1}).catch(function(e){console.log(e)})}},components:{breadCrumb:s.a,TinymceEditor:n.a,uploadFile:a.a}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("breadCrumb",{attrs:{data:e.navData}}),e._v(" "),s("div",{staticClass:"containner"},[s("div",{staticClass:"session"},[s("div",{staticClass:"navTitle"},[s("span",{staticClass:"title"},[e._v("基本信息")]),e._v(" "),s("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){e.editMessage=!e.editMessage}}})]),e._v(" "),0==e.editMessage?s("div",{staticClass:"content specialContent"},[s("div",{staticClass:"item"},[s("img",{attrs:{src:i("fZz7"),alt:""}}),e._v(" "),s("span",{staticClass:"description"},[s("div",[e._v("实验名称："+e._s(e.detail.experimentName))]),e._v(" "),s("div",[e._v("实验状态："),s("span",{staticClass:"colorText"},[e._v(e._s(e._f("recordStatus")(e.detail.experimentStatus)))])]),e._v(" "),s("div",[e._v("解锁阈值："),s("span",{staticClass:"colorText"},[e._v(e._s(e.detail.valve))])])])])]):s("div",{staticClass:"content editMessage specialContent"},[s("div",{staticClass:"item"},[e._m(0),e._v(" "),s("span",{staticClass:"description"},[s("el-form",{ref:"detail",attrs:{rules:e.rules,model:e.detail,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"课程名称",prop:"experimentName"}},[s("el-input",{model:{value:e.detail.experimentName,callback:function(t){e.$set(e.detail,"experimentName",t)},expression:"detail.experimentName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"课程简介"}},[s("el-input",{model:{value:e.detail.experimentIntro,callback:function(t){e.$set(e.detail,"experimentIntro",t)},expression:"detail.experimentIntro"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"解锁阈值"}},[s("el-radio-group",{model:{value:e.form.isAnswerQuezhi,callback:function(t){e.$set(e.form,"isAnswerQuezhi",t)},expression:"form.isAnswerQuezhi"}},[s("el-radio",{attrs:{label:"0"}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:"1"}},[e._v("否")])],1),e._v(" "),0==e.form.isAnswerQuezhi?s("el-form-item",{attrs:{prop:"valve"}},[s("el-input",{staticStyle:{width:"120px"},model:{value:e.detail.valve,callback:function(t){e.$set(e.detail,"valve",t)},expression:"detail.valve"}}),e._v(" "),s("el-alert",{staticStyle:{"line-height":"1em","margin-top":"1em"},attrs:{title:"提示：当学生点击查看参考答案时，最终实验成绩=教师打分*阈值比例",type:"info","show-icon":""}})],1):e._e()],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.updateInfo("detail")}}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.closeInfo()}}},[e._v("取消")])],1)],1)],1)])])]),e._v(" "),s("div",{staticClass:"session"},[s("div",{staticClass:"navTitle"},[s("span",{staticClass:"title"},[e._v("实验详情")]),e._v(" "),s("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){e.editDetail=!e.editDetail}}})]),e._v(" "),0==e.editDetail?s("div",{staticClass:"content",domProps:{innerHTML:e._s(e.detail.experimentText)}}):s("div",{staticClass:"content"},[s("tinymceEditor",{model:{value:e.detail.experimentText,callback:function(t){e.$set(e.detail,"experimentText",t)},expression:"detail.experimentText"}}),e._v(" "),s("div",{staticClass:"btnGroup-center"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.updateDetail()}}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.closeDetail()}}},[e._v("取消")])],1)],1)]),e._v(" "),s("div",{staticClass:"session"},[s("div",{staticClass:"navTitle"},[s("span",{staticClass:"title"},[e._v("实验附件")]),e._v(" "),s("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){e.editFile=!e.editFile}}})]),e._v(" "),0==e.editFile?s("div",{staticClass:"content"},e._l(e.detail.experimentDetailFile,function(t,i){return s("p",{key:i},[s("a",{attrs:{href:t.filePath}},[e._v(e._s(t.fileName))])])}),0):s("div",{staticClass:"content"},[s("uploadFile",{attrs:{allFile:e.detail.experimentDetailFile,someFile:e.experimentDetailFile},on:{updateFile:e.updateDetailFile,closeFile:e.closeDetailFile}})],1)]),e._v(" "),s("div",{staticClass:"session"},[s("div",{staticClass:"navTitle"},[s("span",{staticClass:"title"},[e._v("实验答案")]),e._v(" "),s("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){e.editAnswer=!e.editAnswer}}})]),e._v(" "),0==e.editAnswer?s("div",{staticClass:"content"},[s("p",{staticClass:"valve colorText"},[e._v("答案阈值："),s("span",[e._v(e._s(e.detail.punishment||"未设置阈值"))])]),e._v(" "),s("p",{staticClass:"answer"},[e._v("实验答案："),s("span",{domProps:{innerHTML:e._s(e.detail.experimentAnswerContent)}})])]):s("div",{staticClass:"content"},[s("div",{staticClass:"simpleInput"},[s("span",{staticClass:"label"},[e._v("答案阈值：")]),s("el-input",{attrs:{size:"small",placeholder:"请输入实验阈值"},model:{value:e.detail.punishment,callback:function(t){e.$set(e.detail,"punishment",t)},expression:"detail.punishment"}})],1),e._v(" "),s("tinymceEditor",{model:{value:e.detail.experimentAnswerContent,callback:function(t){e.$set(e.detail,"experimentAnswerContent",t)},expression:"detail.experimentAnswerContent"}}),e._v(" "),s("div",{staticClass:"btnGroup-center"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.updateAnswer()}}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.closeAnswer()}}},[e._v("取消")])],1)],1)]),e._v(" "),s("div",{staticClass:"session"},[s("div",{staticClass:"navTitle"},[s("span",{staticClass:"title"},[e._v("实验答案附件")]),e._v(" "),s("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){e.editAnswerFile=!e.editAnswerFile}}})]),e._v(" "),0==e.editAnswerFile?s("div",{staticClass:"content"},e._l(e.detail.experimentAnswerFile,function(t,i){return s("p",{key:i},[s("a",{attrs:{href:t.filePath}},[e._v(e._s(t.fileName))])])}),0):s("div",{staticClass:"content"},[s("el-upload",{ref:"uploadAnswerFile",staticClass:"uploadFile",attrs:{action:"/teaching/common/file/upload","file-list":e.experimentAnswerFile,"on-change":e.handleAnswerFileSuccess,"on-remove":e.handleAnswerFileRemove}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传附件")]),e._v(" "),s("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("可上传最多30个答案附件，单个附件不可超过300MB")])],1),e._v(" "),s("div",{staticClass:"btnGroup"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.updateAnswerFile()}}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.closeAnswerFile()}}},[e._v("取消")])],1)],1)]),e._v(" "),s("div",{staticClass:"session"},[e._m(1),e._v(" "),s("div",{staticClass:"content operation"},[s("el-row",[0==e.isLock?s("span",[s("el-button",{staticStyle:{"background-color":"#F79500"},attrs:{disabled:e.isOver},on:{click:function(t){return e.lockExperiment()}}},[e._v("锁定实验")])],1):e._e(),e._v(" "),1==e.isLock?s("span",[s("el-button",{attrs:{type:"success",disabled:e.isOver},on:{click:function(t){return e.recoverExperiment()}}},[e._v("解锁实验")])],1):e._e(),e._v(" "),s("span",[s("el-button",{attrs:{type:"danger",disabled:e.isOver},on:{click:function(t){return e.overExperiment()}}},[e._v("完结实验")])],1),e._v(" "),s("span",[s("el-button",{attrs:{type:"info",disabled:!e.isOver},on:{click:function(t){return e.delExperiment()}}},[e._v("删除实验")])],1)]),e._v(" "),s("div",{staticClass:"btnText"},[e._v("注：只有已结束的课程才可以被删除")])],1)])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"imageBox"},[t("img",{attrs:{src:i("fZz7"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"navTitle"},[t("span",{staticClass:"title"},[this._v("实验操作")])])}]};var o=i("VU/8")(l,r,!1,function(e){i("8N5Y")},"data-v-95bd0166",null);t.default=o.exports}});
//# sourceMappingURL=22.a020426e41ac421982f7.js.map