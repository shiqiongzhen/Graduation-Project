webpackJsonp([30],{Tss4:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("5YLu"),a=r("ZmIX"),s=r("iub5"),c=r.n(s),n={props:{},data:function(){return{navData:[{name:"首页",path:"/admin"},{name:"导入已有课程",path:""}],form:{courseValue:"",courseCode:"",courseName:"",teacherId:"",courseCredit:"",courseIntroduction:"",fromData:[],toData:[],imageUrl:""},mode:"transfer",title:["未加入课程学生","已加入课程学生"],courseOptions:[],rules:{courseValue:[{required:!0,message:"不能为空",trigger:"blur"}],courseName:[{required:!0,message:"不能为空",trigger:"blur"}],courseCode:[{required:!0,message:"不能为空",trigger:"blur"}],courseCredit:[{required:!0,message:"不能为空",trigger:"blur"}]}}},computed:{},created:function(){var e=this;this.$http.get("/teaching/teacher/course/courseImport").then(function(t){"0"==t.data.code?e.courseOptions=t.data.data.options:e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)}),this.$http.get("/teaching/teacher/course/classSelectList").then(function(t){"0"==t.data.code?e.form.fromData=t.data.data:e.$message({message:t.data.msg,type:"error"})}).catch(function(e){console.log(e)})},mounted:function(){},watch:{},methods:{changeCourseValue:function(e){var t=this;this.$http.get("/teaching/teacher/course/courseImport?courseId="+e).then(function(e){"0"==e.data.code?(t.form.courseCode=e.data.data.course.courseCode,t.form.imageUrl=e.data.data.course.courseCover,t.form.courseCredit=e.data.data.course.courseCredit,t.form.courseIntroduction=e.data.data.course.courseIntroduction,t.form.courseName=e.data.data.course.courseName):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){console.log(e)})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){0!=t.form.toData.length?e&&t.$http.post("/teaching/teacher/course/import",{courseId:t.form.courseValue,courseCode:t.form.courseCode,courseName:t.form.courseName,teacherId:localStorage.getItem("userId"),courseCredit:t.form.courseCredit,courseIntroduction:t.form.courseIntroduction,addStudentIdList:t.transToData(t.form.toData),courseCover:t.form.imageUrl}).then(function(e){"0"==e.data.code?(t.$message({message:"成功导入课程！",type:"success"}),t.$router.push("/admin")):"1"==e.data.code?t.$router.push("/login"):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){console.log(e)}):t.$message({message:"班级学生不能为空",type:"error"})})},cancle:function(){this.$router.push("/admin")},beforeAvatarUpload:function(e){var t=this,r="image/jpeg"===e.type,o=e.size/1024/1024<2;if(r||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&o){var a=new FormData;return a.append("file",e),this.$http.post("/teaching/common/file/uploadPic",a).then(function(e){t.form.imageUrl=e.data.data.url}).catch(function(e){t.$message({message:"上传失败！"+e,type:"error"})}),!1}return!1},changeMode:function(){"transfer"==this.mode?this.mode="addressList":this.mode="transfer"},transToData:function(e){for(var t=[],r=0;r<e.length;r++)if(e[r].children)for(var o=0;o<e[r].children.length;o++)t.push(e[r].children[o].id);return t},add:function(e,t,r){this.form.toData=t},remove:function(e,t,r){this.form.toData=t}},components:{breadCrumb:a.a,TinymceEditor:o.a,treeTransfer:c.a}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page"},[r("div",{staticClass:"containner"},[r("breadCrumb",{attrs:{data:e.navData}}),e._v(" "),r("div",{staticClass:"contain"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"选择已有课程",prop:"courseValue"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.changeCourseValue},model:{value:e.form.courseValue,callback:function(t){e.$set(e.form,"courseValue",t)},expression:"form.courseValue"}},e._l(e.courseOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),r("el-alert",{staticStyle:{"line-height":"1em","margin-top":"1em"},attrs:{title:"提示：选择已有课程，即可选择导入已创建课程的相关信息与实验信息",type:"info","show-icon":""}})],1),e._v(" "),r("el-form-item",{attrs:{label:"课程名称",prop:"courseName"}},[r("el-input",{model:{value:e.form.courseName,callback:function(t){e.$set(e.form,"courseName",t)},expression:"form.courseName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"班级",rules:{required:!0}}},[r("tree-transfer",{attrs:{title:e.title,height:"300px",from_data:e.form.fromData,to_data:e.form.toData,defaultProps:{label:"label"},mode:e.mode,filter:"",openAll:""},on:{addBtn:e.add,removeBtn:e.remove}})],1),e._v(" "),r("el-form-item",{attrs:{label:"课程代码",prop:"courseCode"}},[r("el-input",{model:{value:e.form.courseCode,callback:function(t){e.$set(e.form,"courseCode",t)},expression:"form.courseCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"课程学分",prop:"courseCredit"}},[r("el-input",{model:{value:e.form.courseCredit,callback:function(t){e.$set(e.form,"courseCredit",t)},expression:"form.courseCredit"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"课程介绍"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入内容"},model:{value:e.form.courseIntroduction,callback:function(t){e.$set(e.form,"courseIntroduction",t)},expression:"form.courseIntroduction"}}),e._v(" "),r("div",{staticClass:"attachTxt"},[e._v("\n                        最多200字\n                    ")])],1),e._v(" "),r("el-form-item",{attrs:{label:"设置课程封面"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"before-upload":e.beforeAvatarUpload}},[r("div",{staticClass:"uploadBox"},[e.form.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])])],1),e._v(" "),r("el-form-item",{staticClass:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确定")]),e._v(" "),r("el-button",{on:{click:e.cancle}},[e._v("取消")])],1)],1)],1)],1)])},staticRenderFns:[]};var i=r("VU/8")(n,u,!1,function(e){r("mBIE")},"data-v-6a72f064",null);t.default=i.exports},mBIE:function(e,t){}});
//# sourceMappingURL=30.4b20244496db54b32d98.js.map